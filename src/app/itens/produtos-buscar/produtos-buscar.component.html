<div class="container">
  <div class="p-grid">
    <form autocomplete="off">
      <div class="p-col-12 mb-3">
        <h1>Produtos</h1>
      </div>
      <div class="p-col-12 p-fluid mb-3">
        <label class="p-mb-2">Buscar Produtos</label>
        <input type="text" pInputText class="p-mt-2" name="nomeBusca" [(ngModel)]="nomeBusca" />
      </div>
      <div class="p-col-12 mb-3" style="display: flex; gap: 10px;">
        <p-dropdown [options]="categorias" [(ngModel)]="categoriaSelecionada" optionLabel="label"
            placeholder="Selecione uma categoria" [ngModelOptions]="{standalone: true}">
        </p-dropdown>
        <p-button label="Buscar" (click)="pesquisar(true)" [disabled]="!(nomeBusca && nomeBusca.trim().length > 0) && !categoriaSelecionada"/>
      </div>

      <div class="p-grid">
        <div class="p-col-12 mb-3">
          <p-table [value]="produtos" styleClass="p-datatable-striped" [tableStyle]="{ 'min-width': '50rem' }" responsiveLayout="stack"
          [breakpoint]="'960px'">
            <ng-template pTemplate="header">
              <tr>
                <th>Nome</th>
                <th class="center-column">Pre√ßo</th>
                <th class="center-column">Estoque</th>
                <th class="center-column">Categoria</th>
                <th class="button-column"></th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-produto>
              <tr>
                <td>{{ produto.nome }}</td>
                <td class="center-column">{{ produto.preco | currency:'BRL'}}</td>
                <td class="center-column">{{ produto.estoque }}</td>
                <td class="center-column">{{ produto.categoria?.nome ?? ' ' }}</td>
                <td class="button-column">
                  <p-button icon="pi pi-user-edit" class="button-spacing" pTooltip="Editar" tooltipPosition="top" (click)="editarProduto(produto)"></p-button>
                  <p-button icon="pi pi-info-circle" class="button-spacing" pTooltip="Detalhar" tooltipPosition="top" (click)="mostrarDetalhes(produto)"></p-button>
                  <p-button icon="pi pi-trash" class="button-spacing" pTooltip="Deletar" tooltipPosition="top" (click)="desativar(produto)" ></p-button>
                </td>

              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </form>

    <div class="p-col-12 mb-3">
      <p-button label="Novo Produto" (click)="novoProduto()"/>
    </div>
    <app-produtos-cadastro [(display)]="displayNovoProduto"></app-produtos-cadastro>
    <app-produtos-detalhes-modal *ngIf="selectedProduto" [produto]="selectedProduto" [(display)]="displayDetalhes"></app-produtos-detalhes-modal>
    <app-produtos-editar-modal *ngIf="selectedProduto" [produto]="selectedProduto" [(display)]="displayEditar" (produtoSalvo)="pesquisar(true)"></app-produtos-editar-modal>

  </div>
</div>
